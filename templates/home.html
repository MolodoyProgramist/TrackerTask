{% extends 'base.html' %}
{% load static %}

{% block content %}
<div class="profile-container">
    <div class="profile-header">
        <img src="{% if user.profile.avatar %}{{ user.profile.avatar.url }}{% else %}https://via.placeholder.com/120{% endif %}"
             alt="User Avatar" class="profile-avatar">
        <div class="profile-info">
            <h2 class="profile-name">{{ user.get_full_name|default:user.username }}</h2>
            <p class="profile-role">{{ user.email }}</p>
            <a href="{% url 'task-list' %}" class="btn btn-primary">‚úÖ –ê–∫—Ç–∏–≤–Ω—ã–µ –∑–∞–¥–∞—á–∏</a>
            <a href="{% url 'task-create' %}" class="btn btn-primary">üìù –î–æ–¥–∞—Ç–∏ –∑–∞–≤–¥–∞–Ω–Ω—è</a>
            <a href="{% url 'task-edit-select' %}" class="btn btn-success">üìù –ü—Ä–∞–≤–∫–∞</a>
            <a href="{% url 'logout' %}" class="logout-button">üîì –í—ã—Ö–æ–¥</a>
        </div>
    </div>

    <div class="profile-stats">
        <div class="stat">
            <span class="stat-number">{{ tasks.count }}</span>
            <span class="stat-label">–í—Å–µ–≥–æ —Å–æ–∑–¥–∞–Ω–æ –∑–∞–¥–∞—á</span>
        </div>
        <div class="stat">
            <span class="stat-number">{{ tasks_completed }}</span>
            <span class="stat-label">–ó–∞–≤–µ—Ä—à–µ–Ω–æ</span>
        </div>
        <div class="stat">
            <span class="stat-number">{{ comments.count }}</span>
            <span class="stat-label">–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤</span>
        </div>
    </div>

    <div class="tasks-section">
        <h3>–ú–æ–∏ –∑–∞–¥–∞—á–∏</h3>
        <table class="tasks-table">
            <thead>
                <tr>
                    <th>–ù–∞–∑–≤–∞–Ω–∏–µ</th>
                    <th>–°—Ç–∞—Ç—É—Å</th>
                    <th>–ó–∞—Ä–ø–ª–∞—Ç–∞</th>
                    <th>–¢–∏–ø</th>
                    <th>–ü—Ä—ñ–æ—Ä–∏—Ç–µ—Ç</th>
                    <th>–¢–µ—Ä–º—ñ–Ω</th>
                    <th>–ê–≤—Ç–æ—Ä</th>
                </tr>
            </thead>
            <tbody>
                {% for task in tasks %}
                <tr>
                    <td><a href="{% url 'task-detail' task.id %}" class="text-decoration-none text-primary">{{ task.title }}</a></td>
                    <td>{{ task.get_status_display }}</td>
                    <td>{{ task.price }}$</td>
                    <td>{{ task.get_type_display }}</td>
                    <td>{{ task.get_priority_display }}</td>
                    <td>{{ task.deadline|date:"d.m.Y H:i" }}</td>
                    <td>{{ task.author.username }}</td>
                </tr>
                {% empty %}
                <tr>
                    <td colspan="5">–£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç –∑–∞–¥–∞—á</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

    <div class="comments-section">
        <h3>–ú–æ–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏</h3>
        <ul class="comments-list">
            {% for comment in comments %}
            <li>
                <strong>{{ comment.task.title }}</strong>: {{ comment.text }}
                <span class="comment-date">{{ comment.created_at|date:"d.m.Y H:i" }}</span>
            </li>
            {% empty %}
            <li>–í—ã –µ—â—ë –Ω–µ –æ—Å—Ç–∞–≤–∏–ª–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤</li>
            {% endfor %}
        </ul>
    </div>
</div>
{% endblock %}
